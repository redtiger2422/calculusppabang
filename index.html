<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>íƒ€ìš”ì™€ í‹°ë‹ˆí•‘ì˜ ìˆ˜í•™ í€´ì¦ˆ</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      text-align: center;
      font-family: 'Arial', sans-serif;
      background-color: #e0f7fa; /* ì—°í•œ íŒŒë‘ ë°°ê²½ */
      color: #444;
    }
    #header {
      position: relative;
      background-color: #ffe0f0; /* ì—°í•œ ë¶„í™ */
      padding: 10px;
      overflow: auto;
    }
    /* ìƒë‹¨ ìºë¦­í„° ì´ë¯¸ì§€ì™€ ì œëª© */
    #header img {
      height: 100px;
    }
    #header h1 {
      color: #ff4081;
      margin: 0;
      line-height: 100px;
      display: inline-block;
    }
    /* ìŒì†Œê±° ë²„íŠ¼ ìœ„ì¹˜ */
    #mute-button {
      font-size: 24px;
      border: none;
      background: none;
      cursor: pointer;
      position: absolute;
      top: 10px;
      right: 10px;
    }
    /* í™”ë©´ë³„ íŒ¨ë”© ë° í—¤ë”© ìƒ‰ìƒ */
    #start-screen, #quiz-screen, #end-screen {
      padding: 20px;
    }
    #start-screen h2, #quiz-screen h2, #end-screen h2 {
      color: #ff4081;
    }
    /* ë²„íŠ¼ ê³µí†µ ìŠ¤íƒ€ì¼ */
    .btn {
      padding: 10px 20px;
      font-size: 16px;
      margin: 5px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    /* ì‹œì‘/ì¬ë„ì „/ì²˜ìŒìœ¼ë¡œ ë²„íŠ¼ ìƒ‰ìƒ */
    #start-button, #retry-button, #home-button {
      background-color: #ffcc80;
    }
    /* ë‹µì•ˆ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
    .answer-button {
      background-color: #ffab91;
      display: block;
      margin: 10px auto;
    }
    .answer-button:hover {
      background-color: #ff8a65;
    }
    /* ë¬¸ì œ í…ìŠ¤íŠ¸ì™€ í”¼ë“œë°± */
    #question-text {
      font-size: 24px;
      margin: 20px 0;
    }
    #feedback {
      font-size: 18px;
      margin: 15px 0;
      height: 24px;
    }
  </style>
</head>
<body>
  <!-- ìƒë‹¨: íƒ€ìš”ì™€ í‹°ë‹ˆí•‘ ì´ë¯¸ì§€, ì œëª©, ìŒì†Œê±° ë²„íŠ¼ -->
  <div id="header">
    <img src="íƒ€ìš”ìë™ì°¨.png" alt="íƒ€ìš”" style="float:left;">
    <img src="í‹°ë‹ˆí•‘ê³µì£¼.png" alt="í‹°ë‹ˆí•‘" style="float:right;">
    <h1>ìˆ˜í•™ í€´ì¦ˆ ëª¨í—˜</h1>
    <button id="mute-button">ğŸ”Š</button>
  </div>

  <!-- ì‹œì‘ í™”ë©´: ë‚˜ì´ ì„ íƒ -->
  <div id="start-screen">
    <h2>ë‚˜ì´ë¥¼ ì„ íƒí•˜ê³  ëª¨í—˜ì„ ì‹œì‘í•´ìš”!</h2>
    <label for="age-select">ë‚˜ì´:</label>
    <select id="age-select">
      <option value="5">5ì„¸</option>
      <option value="6">6ì„¸</option>
      <option value="7">7ì„¸</option>
      <option value="8">8ì„¸</option>
      <option value="9">9ì„¸</option>
      <option value="10">10ì„¸</option>
      <option value="11">11ì„¸</option>
      <option value="12">12ì„¸</option>
    </select>
    <br><br>
    <button id="start-button" class="btn">ëª¨í—˜ ì‹œì‘</button>
  </div>

  <!-- í€´ì¦ˆ í™”ë©´: ë¬¸ì œì™€ ë‹µì•ˆ -->
  <div id="quiz-screen" style="display:none;">
    <h2 id="question-text">ë¬¸ì œ</h2>
    <div id="answers"></div>
    <p id="feedback"></p>
    <p>ë¬¸ì œ <span id="current-question">0</span> / 20</p>
  </div>

  <!-- ì¢…ë£Œ í™”ë©´: ì ìˆ˜ ë° ê²©ë ¤ ë©”ì‹œì§€ -->
  <div id="end-screen" style="display:none;">
    <h2>ëª¨í—˜ì´ ëë‚¬ì–´ìš”!</h2>
    <p id="final-score"></p>
    <p id="encouragement"></p>
    <button id="retry-button" class="btn">ì¬ë„ì „</button>
    <button id="home-button" class="btn">ì²˜ìŒìœ¼ë¡œ</button>
  </div>

  <!-- ë°°ê²½ìŒì•…ê³¼ íš¨ê³¼ìŒ (ê°™ì€ í´ë” ë‚´ íŒŒì¼) -->
  <audio id="bgm" src="tayo1.mp3" loop autoplay></audio>
  <audio id="applause" src="applaus11.mp3"></audio>

<script>
let age = 5;
let totalQuestions = 20;
let currentQuestion = 0;
let score = 0;
let questions = [];
let applauseCooldown = false;

// íƒ€ìš”/í‹°ë‹ˆí•‘ ìŠ¤íƒ€ì¼ ì¹­ì°¬ ë¬¸êµ¬ ëª©ë¡
const praises = [
  "ì™€~ ì •ë§ ë©‹ì ¸ìš”! ğŸ¤©",
  "ì •ë‹µì´ì—ìš”! ì§ì§ì§ ğŸ‘",
  "ë”°ë¥´ë¦‰! ì •ë‹µì…ë‹ˆë‹¤ìš”! ğŸšŒğŸ‰",
  "ì˜¤ì˜ˆ! í‹°ë‹ˆí•‘ë„ ë¿Œë“¯í•´ìš”! ğŸ‘‘âœ¨",
  "ëŒ€ë‹¨í•´ìš”! ëª¨ë‘ê°€ ë†€ëì–´ìš”! ğŸŒŸ",
  "ìš°ì™€~ ì²œì¬ì¸ê°€ ë´ìš”! ğŸŒˆ"
];

// ë²„íŠ¼ ì´ë²¤íŠ¸ ì—°ê²°
document.getElementById('start-button').addEventListener('click', startQuiz);
document.getElementById('retry-button').addEventListener('click', retryQuiz);
document.getElementById('home-button').addEventListener('click', goHome);
document.getElementById('mute-button').addEventListener('click', toggleMute);

// í€´ì¦ˆ ì‹œì‘
function startQuiz() {
  age = parseInt(document.getElementById('age-select').value);
  document.getElementById('start-screen').style.display = 'none';
  document.getElementById('quiz-screen').style.display = 'block';
  currentQuestion = 0;
  score = 0;
  document.getElementById('feedback').textContent = '';
  generateQuestions();
  showQuestion();
}

// ì¬ë„ì „: ë™ì¼ ì—°ë ¹ìœ¼ë¡œ ë‹¤ì‹œ ì‹œì‘
function retryQuiz() {
  currentQuestion = 0;
  score = 0;
  document.getElementById('final-score').textContent = '';
  document.getElementById('encouragement').textContent = '';
  document.getElementById('end-screen').style.display = 'none';
  document.getElementById('quiz-screen').style.display = 'block';
  document.getElementById('feedback').textContent = '';
  generateQuestions();
  showQuestion();
}

// ì²˜ìŒìœ¼ë¡œ: ì—°ë ¹ ì„ íƒ í™”ë©´ìœ¼ë¡œ ëŒì•„ê°
function goHome() {
  document.getElementById('end-screen').style.display = 'none';
  document.getElementById('start-screen').style.display = 'block';
}

// 20ë¬¸ì œ ìƒì„±
function generateQuestions() {
  questions = [];
  for (let i = 0; i < totalQuestions; i++) {
    questions.push(generateQuestion());
  }
}

// ëœë¤ ë¬¸ì œ ìƒì„± (ì—°ë ¹ì— ë”°ë¼ ì‚¬ì¹™ì—°ì‚° í¬í•¨)
function generateQuestion() {
  let num1, num2, operator, questionText, correct;
  const ops = ['+', '-'];
  if (age >= 8) {
    ops.push('Ã—');
  }
  operator = ops[Math.floor(Math.random() * ops.length)];
  if (operator === '+') {
    num1 = Math.floor(Math.random() * 10) + 1;
    num2 = Math.floor(Math.random() * 10) + 1;
    correct = num1 + num2;
  } else if (operator === '-') {
    num1 = Math.floor(Math.random() * 10) + 1;
    num2 = Math.floor(Math.random() * num1) + 1; // ìŒìˆ˜ ë°©ì§€
    correct = num1 - num2;
  } else { // 'Ã—'
    num1 = Math.floor(Math.random() * 5) + 1;
    num2 = Math.floor(Math.random() * 5) + 1;
    correct = num1 * num2;
  }
  questionText = `${num1} ${operator} ${num2} = ?`;
  // ì •ë‹µê³¼ ì˜¤ë‹µ 3ê°œ ìƒì„±
  let options = [correct];
  while (options.length < 4) {
    let wrong;
    if (operator === 'Ã—') {
      wrong = correct + (Math.floor(Math.random() * 5) - 2);
    } else {
      wrong = correct + (Math.floor(Math.random() * 7) - 3);
    }
    if (wrong < 0) wrong = Math.abs(wrong) + 1;
    if (!options.includes(wrong) && wrong !== correct) {
      options.push(wrong);
    }
  }
  // ë³´ê¸° ìˆœì„œ ì„ê¸°
  options.sort(() => Math.random() - 0.5);
  return {questionText, correct, options};
}

// í™”ë©´ì— ë¬¸ì œ í‘œì‹œ
function showQuestion() {
  if (currentQuestion >= totalQuestions) {
    endQuiz();
    return;
  }
  const q = questions[currentQuestion];
  document.getElementById('current-question').textContent = currentQuestion + 1;
  document.getElementById('question-text').textContent = q.questionText;
  const answersDiv = document.getElementById('answers');
  answersDiv.innerHTML = '';
  q.options.forEach(option => {
    const btn = document.createElement('button');
    btn.textContent = option;
    btn.className = 'btn answer-button';
    btn.onclick = () => checkAnswer(option, btn);
    answersDiv.appendChild(btn);
  });
}

// ì‚¬ìš©ìê°€ ë‹µì•ˆ ì„ íƒ ì‹œ
function checkAnswer(selected, btn) {
  const q = questions[currentQuestion];
  const feedback = document.getElementById('feedback');
  // ëª¨ë“  ë‹µì•ˆ ë²„íŠ¼ ë¹„í™œì„±í™”
  const buttons = document.querySelectorAll('.answer-button');
  buttons.forEach(b => b.disabled = true);

  if (selected === q.correct) {
    score++;
    feedback.textContent = praises[Math.floor(Math.random() * praises.length)];
    playApplause(); // ì •ë‹µ íš¨ê³¼ìŒ
    btn.style.backgroundColor = '#a5d6a7'; // ì •ë‹µ ì‹œ ì´ˆë¡
  } else {
    feedback.textContent = "ì•„ì‰½ì§€ë§Œ í‹€ë ¸ì–´ìš”~ ğŸ˜¢";
    btn.style.backgroundColor = '#ef9a9a'; // ì˜¤ë‹µ ì‹œ ë¹¨ê°•
  }
  currentQuestion++;
  // ë‹¤ìŒ ë¬¸ì œë¡œ ì´ë™ (0.8ì´ˆ í›„)
  setTimeout(showQuestion, 800);
}

// í€´ì¦ˆ ì¢…ë£Œ ì²˜ë¦¬
function endQuiz() {
  document.getElementById('quiz-screen').style.display = 'none';
  document.getElementById('end-screen').style.display = 'block';
  document.getElementById('final-score').textContent = `ì ìˆ˜: ${score} / ${totalQuestions}`;
  const encouragement = document.getElementById('encouragement');
  if (score === totalQuestions) {
    encouragement.textContent = "ëª¨ë“  ë¬¸ì œë¥¼ ë§í˜”ì–´ìš”! ì •ë§ ìµœê³ ì—ìš”! ğŸŒŸ";
  } else if (score > totalQuestions * 0.7) {
    encouragement.textContent = "ì •ë§ ì˜í–ˆì–´ìš”! ì¡°ê¸ˆë§Œ ë” í•˜ë©´ ë§Œì ì´ì—ìš”! ğŸ˜‰";
  } else if (score > totalQuestions * 0.4) {
    encouragement.textContent = "ì¢‹ì€ ë„ì „ì´ì—ˆì–´ìš”! ë‹¤ìŒì— ë‹¤ì‹œ í•´ë´ìš”~ ğŸ˜Š";
  } else {
    encouragement.textContent = "ì˜í–ˆì–´ìš”! ë‹¤ìŒì—” ë” ì˜í•  ìˆ˜ ìˆì„ê±°ì˜ˆìš”! ğŸ’ª";
  }
}

// ìŒì†Œê±° í† ê¸€
function toggleMute() {
  const bgm = document.getElementById('bgm');
  bgm.muted = !bgm.muted;
  document.getElementById('mute-button').textContent = bgm.muted ? 'ğŸ”‡' : 'ğŸ”Š';
}

// ë°•ìˆ˜ ì†Œë¦¬ ì¬ìƒ (1.5ì´ˆ ì¿¨íƒ€ì„)
function playApplause() {
  const applause = document.getElementById('applause');
  if (!applauseCooldown) {
    applause.play();
    applauseCooldown = true;
    setTimeout(() => { applauseCooldown = false; }, 1500);
  }
}

// ë¡œë“œ ì‹œ ë°°ê²½ìŒì•… ë³¼ë¥¨ ì¡°ì •
window.addEventListener('load', () => {
  document.getElementById('bgm').volume = 0.5;
});
</script>
</body>
</html>
