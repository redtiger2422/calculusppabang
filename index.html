<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>íƒ€ìš” & í‹°ë‹ˆí•‘ ìˆ˜í•™ ëª¨í—˜</title>
  <style>
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
      background: linear-gradient(120deg, #a1e0ff 40%, #f9e0ff 100%);
      box-sizing: border-box;
      font-family: 'Spoqa Han Sans Neo', 'Noto Sans KR', Arial, sans-serif;
    }
    body {
      height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
    }
    
    /* ì˜¤í”„ë‹ ë¹„ë””ì˜¤ ìŠ¤íƒ€ì¼ */
    #openingVideo {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: #000;
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }
    
    #openingVideo video {
      width: 100%;
      height: 100%;
      object-fit: contain;
    }
    
    #skipButton {
      position: absolute;
      top: 20px;
      right: 20px;
      background: rgba(255, 255, 255, 0.8);
      color: #333;
      border: none;
      padding: 10px 20px;
      border-radius: 5px;
      cursor: pointer;
      font-size: 14px;
      font-weight: bold;
      z-index: 1001;
      transition: background 0.3s;
    }
    
    #skipButton:hover {
      background: rgba(255, 255, 255, 0.95);
    }
    
    #gameContainer {
      width: 100%;
      height: 100%;
      display: none;
      justify-content: center;
      align-items: center;
    }
    
    #gameBox {
      background: rgba(255,255,255,0.95);
      border-radius: 20px;
      box-shadow: 0 6px 40px rgba(20,60,160,0.17);
      padding: 32px 24px 20px 24px;
      max-width: 420px;
      min-width: 330px;
      width: 90vw;
      margin: 0 auto;
      position: relative;
      text-align: center;
    }
    #logoImages {
      display: flex;
      justify-content: center;
      align-items: flex-end;
      gap: 10px;
      margin-bottom: 12px;
    }
    .logo-char {
      height: 60px;
      border-radius: 10px;
      object-fit: contain;
      box-shadow: 0 3px 15px rgba(30,70,180,0.11);
      background: #eaf6ff;
      padding: 3px;
    }
    #adventureMsg {
      margin-bottom: 12px;
    }
    #adventureMsg div {
      color: #3186eb;
      font-size: 1.32em;
      font-weight: bold;
      letter-spacing: 1px;
      text-shadow: 0 1px 5px #fff6;
      animation: bounce 2.2s infinite;
      margin: 4px 0;
    }
    @keyframes bounce {
      0% { transform: translateY(0); }
      15% { transform: translateY(-6px); }
      30% { transform: translateY(0); }
      50% { transform: translateY(-4px); }
      70% { transform: translateY(0); }
    }
    label, select, button, input {
      font-size: 1.15em;
    }
    select, input {
      padding: 7px 12px;
      border-radius: 6px;
      border: 1.2px solid #aad3fd;
      margin-bottom: 12px;
      width: 70%;
      max-width: 200px;
      background: #f5fbff;
    }
    button {
      margin-top: 5px;
      background: #66b5f6;
      color: white;
      font-weight: bold;
      padding: 8px 24px;
      border: none;
      border-radius: 7px;
      cursor: pointer;
      box-shadow: 0 2px 7px #88c6fc55;
      transition: background 0.2s;
    }
    button:hover { background: #3d97e0; }
    #questionNum {
      font-size: 1.07em;
      color: #9791cf;
      margin-bottom: 5px;
    }
    #questionText {
      font-size: 1.6em;
      font-weight: bold;
      color: #3677b6;
      margin-bottom: 18px;
      margin-top: 0;
    }
    #answerInput {
      text-align: center;
      font-weight: bold;
      letter-spacing: 1px;
    }
    #feedback {
      min-height: 1.1em;
      font-size: 1.13em;
      font-weight: 500;
      margin: 7px 0 0 0;
      color: #fa7e2e;
    }
    #resultSection {
      margin: 0 0 10px 0;
    }
    #resultSection h2 {
      color: #3a7fbc;
      margin-bottom: 5px;
    }
    #resultMsg {
      font-size: 1.14em;
      margin: 12px 0 8px 0;
      color: #6864e2;
    }
    #madeBy {
      font-size: 0.99em;
      color: #aaa;
      margin-top: 18px;
      letter-spacing: 1.5px;
      text-align: center;
      width: 100%;
      position: relative;
    }
    #muteBtn {
      position: absolute;
      top: 12px;
      right: 16px;
      background: none;
      border: none;
      font-size: 1.45em;
      cursor: pointer;
      z-index: 99;
      color: #3186eb;
      user-select: none;
      padding: 0;
    }
    @media (max-width: 500px) {
      #gameBox {
        min-width: unset;
        padding: 8vw 2vw 5vw 2vw;
      }
      .logo-char {
        height: 44px;
      }
      #muteBtn {
        right: 10px;
        top: 8px;
      }
      #skipButton {
        top: 10px;
        right: 10px;
        padding: 8px 16px;
        font-size: 12px;
      }
    }
  </style>
</head>
<body>
  <!-- ì˜¤í”„ë‹ ë¹„ë””ì˜¤ ì„¹ì…˜ -->
  <div id="openingVideo">
    <video id="openingVideoPlayer" autoplay>
      <source src="openvd.mp4" type="video/mp4">
      ë¸Œë¼ìš°ì €ê°€ ë¹„ë””ì˜¤ë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
    </video>
    <button id="skipButton">ê±´ë„ˆë›°ê¸°</button>
  </div>

  <!-- ê²Œì„ ì»¨í…Œì´ë„ˆ -->
  <div id="gameContainer">
    <div id="gameBox">
      <button id="muteBtn" title="ìŒì†Œê±° ì „í™˜">ğŸ”Š</button>
      <div id="logoImages">
        <img src="í‹°ë‹ˆí•‘ê³µì£¼.png" alt="í‹°ë‹ˆí•‘ê³µì£¼" class="logo-char">
        <img src="íƒ€ìš”ìë™ì°¨.png" alt="íƒ€ìš”ìë™ì°¨" class="logo-char">
      </div>
      <div id="adventureMsg">
        <div>ğŸ’¡ ì‹ ë‚˜ëŠ” íƒ€ìš”ì™€ í‹°ë‹ˆí•‘ì˜ ìˆ˜í•™ ëª¨í—˜!ğŸ’¡</div>
        <div>ğŸš˜ ì§€ê¸ˆ ë– ë‚˜ìš”! ğŸš˜</div>
      </div>
      <!-- ë‚˜ì´ ì„ íƒ í™”ë©´ -->
      <div id="ageSection">
        <label for="ageSelect">ë‚˜ì´ë¥¼ ì„ íƒí•˜ì„¸ìš” (5ì„¸~13ì„¸):</label><br>
        <select id="ageSelect">
          <option value="">-- ë‚˜ì´ ì„ íƒ --</option>
          <option value="5">5ì„¸</option><option value="6">6ì„¸</option><option value="7">7ì„¸</option>
          <option value="8">8ì„¸</option><option value="9">9ì„¸</option><option value="10">10ì„¸</option>
          <option value="11">11ì„¸</option><option value="12">12ì„¸</option><option value="13">13ì„¸</option>
        </select>
        <br><button id="startQuizBtn">ëª¨í—˜ ì‹œì‘!</button>
      </div>
      <!-- ë¬¸ì œ í€´ì¦ˆ í™”ë©´ -->
      <div id="quizSection" style="display:none;">
        <div id="questionNum"></div>
        <div id="questionText"></div>
        <input id="answerInput" type="text" autocomplete="off" placeholder="ì •ë‹µì„ ì¨ì£¼ì„¸ìš”!">
        <br><button id="submitAnswerBtn">ì •ë‹µ í™•ì¸</button>
        <div id="feedback"></div>
      </div>
      <!-- ê²°ê³¼ í™”ë©´ -->
      <div id="resultSection" style="display:none;">
        <h2>ğŸ‰ ëª¨í—˜ ì™„ë£Œ! ğŸ‰</h2>
        <div>ë§ì¶˜ ê°œìˆ˜: <span id="correctCount"></span> / <span id="totalCount"></span></div>
        <div>ì •ë‹µë¥ : <span id="accuracy"></span>%</div>
        <div id="resultMsg"></div>
        <button id="retryBtn" style="display:none;">ì¬ë„ì „í•˜ê¸°</button>
        <button id="restartBtn">ì²˜ìŒìœ¼ë¡œ</button>
      </div>
      <div id="madeBy">Made by ì í˜¸ì•½ì‚¬</div>
    </div>
  </div>

  <!-- ë°°ê²½ ìŒì•…, íš¨ê³¼ìŒ -->
  <audio id="bgMusic" src="tayo1.mp3" loop></audio>
  <audio id="applauseSound" src="coin.mp3" preload="auto"></audio>

  <script>
    let quiz = { age: null, questions: [], current: 0, correct: 0 };
    let applauseCooldown = false;
    let bgMusicStarted = false;

    // ì˜¤í”„ë‹ ë¹„ë””ì˜¤ ê´€ë ¨ ìŠ¤í¬ë¦½íŠ¸
    const openingVideo = document.getElementById('openingVideoPlayer');
    const openingContainer = document.getElementById('openingVideo');
    const gameContainer = document.getElementById('gameContainer');
    const skipButton = document.getElementById('skipButton');
    const bgMusic = document.getElementById('bgMusic');

    // ë¹„ë””ì˜¤ê°€ ëë‚¬ì„ ë•Œ ê²Œì„ìœ¼ë¡œ ì „í™˜
    openingVideo.addEventListener('ended', function() {
      showGame();
    });

    // ë¹„ë””ì˜¤ ì—ëŸ¬ ì‹œ ê²Œì„ìœ¼ë¡œ ì „í™˜
    openingVideo.addEventListener('error', function() {
      console.error('ë¹„ë””ì˜¤ë¥¼ ì¬ìƒí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
      showGame();
    });

    // ê±´ë„ˆë›°ê¸° ë²„íŠ¼ í´ë¦­ ì‹œ
    skipButton.addEventListener('click', function() {
      showGame();
    });

    // ê²Œì„ í™”ë©´ í‘œì‹œ í•¨ìˆ˜
    function showGame() {
      openingContainer.style.display = 'none';
      gameContainer.style.display = 'flex';
      if (!bgMusicStarted) {
        bgMusic.volume = 0.4;
        bgMusic.play().catch(e => {
          console.log('ë°°ê²½ìŒì•… ìë™ì¬ìƒì´ ì°¨ë‹¨ë˜ì—ˆìŠµë‹ˆë‹¤. ì‚¬ìš©ì ìƒí˜¸ì‘ìš© í›„ ì¬ìƒë©ë‹ˆë‹¤.');
        });
        bgMusicStarted = true;
      }
    }

    // ê¸°ì¡´ ê²Œì„ ìŠ¤í¬ë¦½íŠ¸
    const feedbacks = {
      correct: [
        'ì •ë‹µ! ë©‹ì ¸ìš” ğŸš', 'ë§ì•˜ì–´ìš”! ğŸ‘‘', 'ëŒ€ë‹¨í•´ìš”! íƒ€ìš”ì²˜ëŸ¼ í˜ì°¨ê²Œ!', 'í˜¹ì‹œ...ë©˜ì‚¬!?' ,
        'í‹°ë‹ˆí•‘ì²˜ëŸ¼ ë°˜ì§ë°˜ì§!', 'ì •ë§ ì˜í–ˆì–´ìš”!', 'ìµœê³ ì˜ˆìš”!', 'í™˜ìƒì ì´ì—ìš”!', 'í›Œë¥­í•´ìš”!'
      ],
      wrong: [
        'ì•„ì‰½ì§€ë§Œ ë‹¤ìŒ ë¬¸ì œë„ í˜ë‚´ìš”!', 'ì¡°ê¸ˆë§Œ ë” ì§‘ì¤‘! ğŸ’ª', 'ê´œì°®ì•„ìš”, í¬ê¸°í•˜ì§€ ë§ˆìš”!', 'ì¡°ê¸ˆë§Œ ë” ì—°ìŠµí•˜ë©´ ê¸ˆë°© ë§ì¶œ ìˆ˜ ìˆì–´ìš”!'
      ]
    };
    function getResultMsg(rate) {
      if (rate >= 90) return 'ìš°ìˆ˜í•´ìš”! ìˆ˜í•™ì²œì¬! ğŸ‘‘ğŸ¦–';
      if (rate >= 80) return 'ì¡°ê¸ˆë§Œ ë” í•˜ë©´ 90%ë„ ê°€ëŠ¥í•´ìš”! í™”ì´íŒ…! ğŸŒˆ';
      return '70%ê°€ ë„˜ì„ ë•Œê¹Œì§€ ì¡°ê¸ˆ ë” ì—°ìŠµí•´ìš”! ì¬ë„ì „ Go! ğŸšğŸ‘‘';
    }
    function randInt(min, max) { return Math.floor(Math.random() * (max - min + 1)) + min; }
    function makeQuestions(age) {
      const arr = [];
      for (let i = 0; i < 20; i++) {
        let q = '', a = 0;
        if (age <= 6) {
          if (Math.random() < 0.5) { let x=randInt(1,10), y=randInt(1,10); q = `${x} + ${y}`; a = x+y; }
          else { let x=randInt(1,10), y=randInt(1,10); let max=Math.max(x,y), min=Math.min(x,y); q = `${max} - ${min}`; a = max-min; }
        } else if (age<=8) {
          let t=Math.random();
          if (t<0.4) { let x=randInt(0,20),y=randInt(0,20-x); q=`${x} + ${y}`; a=x+y; }
          else if (t<0.8) { let x=randInt(0,20),y=randInt(0,x); q=`${x} - ${y}`; a=x-y; }
          else { let x=randInt(1,5),y=randInt(1,5); q=`${x} Ã— ${y}`; a=x*y; }
        } else if (age<=10) {
          let t=Math.random();
          if (t<0.25) { let x=randInt(0,10),y=randInt(0,10); q=`${x} + ${y}`; a=x+y; }
          else if (t<0.5) { let x=randInt(0,10),y=randInt(0,10),mx=Math.max(x,y),mn=Math.min(x,y); q=`${mx} - ${mn}`; a=mx-mn; }
          else if (t<0.75) { let x=randInt(1,10),y=randInt(1,10); q=`${x} Ã— ${y}`; a=x*y; }
          else { let x=randInt(1,10),y=randInt(1,10),p=x*y; q=`${p} Ã· ${x}`; a=p/x; }
        } else {
          let two=Math.random()<0.3;
          if (!two) {
            let t=Math.random();
            if (t<0.25) { let x=randInt(0,50),y=randInt(0,50); q=`${x} + ${y}`; a=x+y; }
            else if (t<0.5) { let x=randInt(0,50),y=randInt(0,x); q=`${x} - ${y}`; a=x-y; }
            else if (t<0.75) { let x=randInt(1,20),y=randInt(1,20); q=`${x} Ã— ${y}`; a=x*y; }
            else { let x=randInt(1,20),y=randInt(1,20),p=x*y; q=`${p} Ã· ${x}`; a=p/x; }
          } else {
            let pat=randInt(1,6); let x,y,z;
            switch(pat) {
              case 1: x=randInt(1,20),y=randInt(1,20),z=randInt(1,10); q=`(${x} + ${y}) Ã— ${z}`; a=(x+y)*z; break;
              case 2: x=randInt(1,10),y=randInt(1,20),z=randInt(1,20); q=`${x} Ã— (${y} + ${z})`; a=x*(y+z); break;
              case 3: x=randInt(1,50),y=randInt(1,x),z=randInt(1,50); q=`(${x} - ${y}) + ${z}`; a=(x-y)+z; break;
              case 4: x=randInt(1,50),y=randInt(1,50),z=randInt(1,x+y); q=`(${x} + ${y}) - ${z}`; a=(x+y)-z; break;
              case 5: x=randInt(1,20),y=randInt(1,10),z=randInt(1,10); q=`${x} + ${y} Ã— ${z}`; a=x+(y*z); break;
              case 6: x=randInt(1,20),y=randInt(1,10),z=randInt(1,x*y); q=`${x} Ã— ${y} - ${z}`; a=(x*y)-z; break;
            }
          }
        }
        arr.push({q:q, a:a});
      }
      return arr.sort(()=>Math.random()-0.5);
    }

    document.getElementById('startQuizBtn').onclick = function() {
      const age = parseInt(document.getElementById('ageSelect').value);
      if (!age || age<5 || age>13) { alert('5~13ì„¸ ë‚˜ì´ë§Œ ì„ íƒ ê°€ëŠ¥í•©ë‹ˆë‹¤!'); return; }
      quiz.age = age;
      quiz.questions = makeQuestions(age);
      quiz.current = 0;
      quiz.correct = 0;
      document.getElementById('ageSection').style.display='none';
      document.getElementById('quizSection').style.display='block';
      document.getElementById('resultSection').style.display='none';
      showQuestion();
      // ë°°ê²½ìŒì•… ì²« ìƒí˜¸ì‘ìš© ì‹œ ì¬ìƒ (ëª¨ë°”ì¼ ëŒ€ì‘)
      if (bgMusic.paused) bgMusic.play();
    };

    function showQuestion() {
      let qinfo = quiz.questions[quiz.current];
      document.getElementById('questionNum').textContent = `ë¬¸ì œ ${quiz.current+1} / 20`;
      document.getElementById('questionText').textContent = qinfo.q+' = ?';
      document.getElementById('answerInput').value = '';
      document.getElementById('feedback').textContent = '';
      document.getElementById('answerInput').focus();
      document.getElementById('submitAnswerBtn').textContent = 'ì •ë‹µ í™•ì¸';
      document.getElementById('submitAnswerBtn').disabled = false;
    }
    document.getElementById('submitAnswerBtn').onclick = function() {
      let userAns = document.getElementById('answerInput').value.trim();
      let q = quiz.questions[quiz.current];
      if(userAns==="") { document.getElementById('feedback').textContent = "ë‹µì„ ì…ë ¥í•´ ì£¼ì„¸ìš”!"; return; }
      if(Number(userAns) === q.a) {
        quiz.correct++;
        document.getElementById('feedback').textContent = feedbacks.correct[randInt(0, feedbacks.correct.length-1)];
        if (!applauseCooldown) {
          document.getElementById('applauseSound').currentTime = 0;
          document.getElementById('applauseSound').play();
          applauseCooldown = true;
          setTimeout(()=>{ applauseCooldown = false; }, 1500);
        }
      } else {
        document.getElementById('feedback').textContent = `${feedbacks.wrong[randInt(0,feedbacks.wrong.length-1)]} (ì •ë‹µ: ${q.a})`;
      }
      document.getElementById('submitAnswerBtn').textContent = 'ë‹¤ìŒ ë¬¸ì œ';
      document.getElementById('submitAnswerBtn').disabled = true;
      setTimeout(()=>{
        quiz.current++;
        if (quiz.current >= 20) finishQuiz();
        else {
          showQuestion();
          document.getElementById('submitAnswerBtn').disabled = false;
        }
      }, 1200);
    };
    document.getElementById('answerInput').addEventListener('keypress', function(e) {
      if (e.key === 'Enter') document.getElementById('submitAnswerBtn').click();
    });

    function finishQuiz() {
      document.getElementById('quizSection').style.display='none';
      document.getElementById('resultSection').style.display='block';
      document.getElementById('correctCount').textContent = quiz.correct;
      document.getElementById('totalCount').textContent = '20';
      let rate = Math.round(quiz.correct/20*100);
      document.getElementById('accuracy').textContent = rate;
      document.getElementById('resultMsg').textContent = getResultMsg(rate);
      document.getElementById('retryBtn').style.display = (rate<70) ? 'inline-block':'none';
    }
    document.getElementById('retryBtn').onclick = function() {
      quiz.current = 0;
      quiz.correct = 0;
      quiz.questions = makeQuestions(quiz.age);
      document.getElementById('ageSection').style.display='none';
      document.getElementById('quizSection').style.display='block';
      document.getElementById('resultSection').style.display='none';
      showQuestion();
    };
    document.getElementById('restartBtn').onclick = function() {
      location.reload();
    };

    document.getElementById('muteBtn').onclick = function() {
      bgMusic.muted = !bgMusic.muted;
      this.textContent = bgMusic.muted ? 'ğŸ”‡' : 'ğŸ”Š';
    };
  </script>
</body>
</html>
